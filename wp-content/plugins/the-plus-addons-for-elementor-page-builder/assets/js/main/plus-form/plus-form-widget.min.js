(function(){"use strict";var a=function(a,b){var c=a[0].querySelector(".tpae-form-container"),d=c.querySelector(".tpae-form"),e=c.dataset.formdata?JSON.parse(c.dataset.formdata):{},f=e.Required_mask,g=c?.dataset?.emaildata?JSON.parse(c.dataset.emaildata):{},h=c.querySelectorAll(".tpae-required-asterisk");h.forEach(function(a){a.style.display="hide-asterisks"===f?"none":"inline"});var i=e.invalid_form||"Invalid form submission.",j=e.success_message||"Your message has been sent successfully.",k=e.form_error||"There was an error with the form submission.",l=e.required_fields||"Please fill in the required fields.",m=e.server_error||"Server error, please try again later.",n=!1;d.addEventListener("submit",function(a){if(a.preventDefault(),!n){n=!0,r();var b=!0,c={},e=[];return d.querySelectorAll(".tpae-form-field").forEach(function(a){var d=a.querySelector("input, textarea"),f=a.querySelector("label")?a.querySelector("label").textContent.trim():"";if(d){var g=d.value.trim(),h=d.getAttribute("id")||"",i=d.getAttribute("name")||"";e.push({field_id:h,field_name:i,field_value:g}),d.required&&""===g&&(b=!1,p(d,l.replace("%field%",f))),c[d.name||f||d.id]=g}}),b?void o(c,e):(s(i,"error"),n=!1,!1)}});var o=function(a,c){return b.ajax({url:theplus_ajax_url,type:"POST",data:{action:"tpae_form_submission",form_data:JSON.stringify(a),email_data:g,form_fields:JSON.stringify(c),security:g.nonce},success:function(a){if(!a?.success)s(k.replace("%error%",a?.data?.message),"error");else if(a?.data?.email_sent){s(j,"success"),d.reset();var b=a?.data?.redirection;b&&b.url&&(b.is_external?window.open(b.url,"_blank","noopener,noreferrer"):window.location.href=b.url)}else s("Emails could not be sent. Please try again.","error")},error:function(a,b,c){s(m.replace("%error%",c),"error")},complete:function(){n=!1}}),!1},p=function(a,b){q(a);var c=document.createElement("span");c.className="tpae-field-error",c.style.color="red",c.textContent=b,a.parentElement.appendChild(c)},q=function(a){var b=a.parentElement.querySelector(".tpae-field-error");b&&b.remove()},r=function(){d.querySelectorAll(".tpae-form-messages").forEach(function(a){a.remove()}),d.querySelectorAll(".tpae-field-error").forEach(function(a){a.remove()})},s=function(a,b){b=b||"success",r();var c=document.createElement("div");c.className="tpae-form-message "+b,c.style.color="success"===b?"green":"red",c.textContent=a,d.appendChild(c)}};window.addEventListener("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/tp-plus-form.default",a)})})(jQuery);