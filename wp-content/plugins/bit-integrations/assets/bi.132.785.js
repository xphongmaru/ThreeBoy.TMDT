var L=Object.defineProperty;var k=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var T=(e,a,n)=>a in e?L(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,b=(e,a)=>{for(var n in a||(a={}))U.call(a,n)&&T(e,n,a[n]);if(k)for(var n of k(a))E.call(a,n)&&T(e,n,a[n]);return e};import{f as V,r as M,j as s,L as y}from"./main-794.js";import{e as B,_ as t}from"./bi.828.0.js";import{a as z,h as G,b as H}from"./bi.499.3.js";import{x as I}from"./bi.266.440.js";import{a as v}from"./bi.685.9.js";import{b as u}from"./bi.690.11.js";import{P as J,a as Z}from"./bi.591.710.js";import{s as P,g as A,a as D}from"./bi.383.786.js";import{T as K}from"./bi.257.704.js";function Q({fluentSupportConf:e,setFluentSupportConf:a,formID:n,formFields:l,setSnackbar:r}){var _,w;const o=V(B),{isPro:g,version:j}=o,[m,d]=M.useState(!1),[c,x]=M.useState({show:!1}),p=(i,F)=>{const N=b({},e);i!==""?N.actions[F]=i:delete N.actions[F],a(b({},N))},O=[{label:t("Normal","bit-integrations"),value:"normal"},{label:t("Critical","bit-integrations"),value:"critical"},{label:t("Medium","bit-integrations"),value:"medium"}],R=()=>{var i;(i=e.default)!=null&&i.agents||P(n,e,a,d,r),x({show:"support_staff"})},q=()=>{var i;(i=e.default)!=null&&i.businessInboxes||A(n,e,a,d,r),x({show:"business_inboxes"})},h=()=>{x({show:!1})};return s.jsxs("div",{className:"pos-rel",children:[s.jsxs("div",{className:"d-flx flx-wrp",children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[s.jsx(u,{onChange:R,checked:"support_staff"in e.actions,className:"wdt-200 mt-4 mr-2",value:"support_staff",title:t("Support Staff","bit-integrations"),subTitle:t("Add a Support Staff to ticket pushed to fluentSupport.","bit-integrations")}),!e.actions.support_staff&&s.jsx("small",{style:{marginLeft:30,marginTop:10,color:"red"},children:t("Support Staff is required","bit-integrations")})]}),s.jsx(u,{onChange:q,checked:"business_inbox"in e.actions,className:"wdt-200 mt-4 mr-2",value:"business_inbox",title:t("Business Inbox","bit-integrations"),subTitle:t("Add Business Inbox on Ticket in fluentSupport.","bit-integrations")}),s.jsx(u,{onChange:()=>x({show:"client_priority"}),checked:"client_priority"in e.actions,className:"wdt-200 mt-4 mr-2",value:"client_priority",title:t("Client Priority","bit-integrations"),subTitle:t("Add Client Priority on Ticket in fluentSupport.","bit-integrations")}),s.jsx(u,{onChange:()=>x({show:"attachment"}),checked:"attachment"in e.actions,className:"wdt-200 mt-4 mr-2",value:"Attachment",isInfo:!g,title:s.jsx(J,{title:t("Attachment","bit-integrations")}),subTitle:s.jsx(Z,{title:t("Upsert Record","bit-integrations"),subTitle:t("Supported Types: Photos, CSV, PDF/Docs, Zip, JSON and max file size: 2.0MB","bit-integrations"),proVersion:"2.1.7"})})]}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:t("Ok","bit-integrations"),show:c.show==="support_staff",close:h,action:h,title:t("Ticket Owner","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2"}),m?s.jsx(y,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsxs("div",{className:"flx flx-between mt-2",children:[s.jsxs("select",{value:e.actions.support_staff,className:"btcd-paper-inp",onChange:i=>p(i.target.value,"support_staff"),children:[s.jsx("option",{value:"",children:t("Select Support Staff","bit-integrations")}),((_=e==null?void 0:e.default)==null?void 0:_.agents)&&e.default.agents.map(i=>s.jsx("option",{value:`${i.id}`,children:`${i.first_name||i.last_name?i.first_name+" "+i.last_name:i.email}`},i.id))]}),s.jsx("button",{onClick:()=>P(n,e,a,d,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Support Staff"'},type:"button",disabled:m,children:"↻"})]})]}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:t("Ok","bit-integrations"),show:c.show==="client_priority",close:h,action:h,title:t("Select Priority","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2"}),s.jsx("div",{className:"mt-2",children:t("Select client priority to ticket.","bit-integrations")}),s.jsx(I,{singleSelect:!0,defaultValue:e.actions.client_priority,className:"mt-2 w-9",onChange:i=>p(i,"client_priority"),options:O})]}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:t("Ok","bit-integrations"),show:c.show==="business_inboxes",close:h,action:h,title:t("Business Inbox","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2"}),m?s.jsx(y,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsxs("div",{className:"flx flx-between mt-2",children:[s.jsxs("select",{value:e.actions.business_inbox,className:"btcd-paper-inp",onChange:i=>p(i.target.value,"business_inbox"),children:[s.jsx("option",{value:"",children:t("Select Business Inbox","bit-integrations")}),((w=e==null?void 0:e.default)==null?void 0:w.businessInboxes)&&e.default.businessInboxes.map(i=>s.jsx("option",{value:`${i.id}`,children:i.name},i.id))]}),s.jsx("button",{onClick:()=>A(n,e,a,d,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Support Staff"'},type:"button",disabled:m,children:"↻"})]})]}),g&&s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:t("Ok","bit-integrations"),show:c.show==="attachment",close:h,action:h,title:t("Select Attachment","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2"}),s.jsx("div",{className:"mt-2",children:t("Select File Upload Fields","bit-integrations")}),s.jsx(I,{defaultValue:e.actions.attachment,className:"mt-2 w-9",onChange:i=>p(i,"attachment"),options:l.filter(i=>i.type==="file").map(i=>({label:i.label,value:i.name})),singleSelect:!0,closeOnSelect:!0})]})]})}const W=(e,a,n)=>{const l=b({},a);l.field_map.splice(e,0,{}),n(b({},l))},X=(e,a,n)=>{const l=b({},a);l.field_map.length>1&&l.field_map.splice(e,1),n(b({},l))},$=(e,a,n,l)=>{const r=b({},n);r.field_map[a][e.target.name]=e.target.value,e.target.value==="custom"&&(r.field_map[a].customValue=""),l(b({},r))};function Y({i:e,formFields:a,field:n,fluentSupportConf:l,setFluentSupportConf:r}){var d;const o=(l==null?void 0:l.fluentSupportFields.filter(c=>c.required===!0))||[],g=(l==null?void 0:l.fluentSupportFields.filter(c=>c.required===!1))||[],j=V(B),{isPro:m}=j;return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:n.formField||"",onChange:c=>$(c,e,l,r),children:[s.jsx("option",{value:"",children:t("Select Field","bit-integrations")}),s.jsx("optgroup",{label:t("Form Fields","bit-integrations"),children:a==null?void 0:a.map(c=>s.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`))}),s.jsx("option",{value:"custom",children:t("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(t("General Smart Codes %s","bit-integrations"),m?"":`(${t("Pro","bit-integrations")})`),children:m&&((d=z)==null?void 0:d.map(c=>s.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`)))})]}),n.formField==="custom"&&s.jsx(K,{onChange:c=>G(c,e,l,r),label:t("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:n.customValue,placeholder:t("Custom Value","bit-integrations"),formFields:a}),s.jsxs("select",{className:"btcd-paper-inp",disabled:e<o.length,name:"fluentSupportFormField",value:e<o.length?o[e].key||"":n.fluentSupportFormField||"",onChange:c=>$(c,e,l,r),children:[s.jsx("option",{value:"",children:t("Select Field","bit-integrations")}),e<o.length?s.jsx("option",{value:o[e].key,children:o[e].label},o[e].key):g.map(({key:c,label:x})=>s.jsx("option",{value:c,children:x},c))]})]}),e>=o.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>W(e,l,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>X(e,l,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function cs({formID:e,formFields:a,handleInput:n,fluentSupportConf:l,setFluentSupportConf:r,isLoading:o,setIsLoading:g,setSnackbar:j}){return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("br",{}),o&&s.jsx(y,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),!o&&l.field_map&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mt-4",children:[s.jsx("b",{className:"wdt-100",children:t("Map Fields","bit-integrations")}),s.jsx("button",{onClick:()=>D(l,r,g,j),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${t("Refresh Custom Ticket Fields","bit-integrations")}'`},type:"button",disabled:o,children:"↻"})]}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:t("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:t("fluentSupport Fields","bit-integrations")})})]}),l.field_map.map((m,d)=>s.jsx(Y,{i:d,field:m,fluentSupportConf:l,formFields:a,setFluentSupportConf:r},`desk-m-${d+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>H(l.field_map.length,l,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:t("Utilities","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(Q,{fluentSupportConf:l,setFluentSupportConf:r,formID:e,formFields:a,setSnackbar:j})]})]})}export{cs as F};
